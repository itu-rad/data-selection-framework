Her er en ny implementation 